<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Title for WebPage</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/data_entry.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/league.css') }}">
    <script src="{{ url_for('static', filename='js/data_entry.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/league.js') }}" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>

    <!-- Sidenav -->
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="/data_entry">Data Entry</a>
        <a href="/Home">Home</a>
    </div>

    <!-- Navbar -->
    <nav class="navbar">
        <!-- From Uiverse.io by Cevorob -->
        <div class="slide">
            <label class="burger" onclick="openNav()" for="burger">
                <input type="checkbox" id="burger">
                <span></span>
                <span></span>
                <span></span>
            </label>
        </div>
        <div class="logo">
            <img src="/static/logo.png" alt="Profile">
        </div>
        <div class="navbar-title">{{nav_name}}</div>
    </nav>
    </pre>
    <section class="scrollable">
        
        <div class="age-stats-container">
            <div class="age-label">Average Player Age</div>
            <div id="average-age" class="age-value">{{avg_age | round(2)}}</div>
            <div class="age-label">years</div>
        </div>

        

        <div class="heatmap-container">
            <div id="position-age-heatmap"></div>
        </div>

        <table id="data-table" style="display: none;">
            <thead>
                <tr>
                    <th>Index</th>
                    <th>Full Name</th>
                    <th>Name</th>
                    <th>Nation</th>
                    <th>League</th>
                    <th>Club</th>
                </tr>
            </thead>
            <tbody>
                {%for data in league_info%}
                    <tr>
                        <td>{{ loop.index }}</td>  
                        <td>{{data.full_name}}</td> 
                        <td>{{data.name}}</td> 
                        <td>{{data.nation_Nation}}</td>
                        <td>{{ data.league_name }}</td> 
                        <td>{{data.club_name}}</td>
                    </tr>
                {%endfor%}
            </tbody>
        </table>
    </section>
    <br>
    <section class="scrollable">
    <div class="bar-chart-container">
        <h2 class="chart-title">Top 5 Player Nationalities</h2>
        <div id="nationality-chart"></div>
    </div>
    </section>
    <section class="scrollable">
        <div class="pyramid-chart-container">
            <h2 class="chart-title">Age Distribution by Position</h2>
            <div class="position-filter">
                <label for="position-select">Select Position:</label>
                <select id="position-select">
                    <option value="all">All Positions</option>
                    {% for stat in position_stats %}
                    <option value="{{ stat.position }}">{{ stat.position }}</option>
                    {% endfor %}
                </select>
            </div>
            <div id="age-pyramid-chart"></div>
        </div>
    </div>
    </section>
    <div id="heatmap-data" style="display: none;">
        {% for stat in position_stats %}
            <div class="position-data" 
                 data-position="{{ stat.position }}">
                {% for group, percent in stat.pos_age_groups.items() %}
                    <span class="age-group-data" 
                          data-group="{{ group }}" 
                          data-percent="{{ percent }}"></span>
                {% endfor %}
            </div>
        {% endfor %}
    </div>

    <h1>value counts:</h1>

    <ul>
        {% for group, age_value in age_counts.items() %}
        <li>Age in years: {{ group }}        Number of players for those years: {{ age_value}}</li>
        {% endfor %}
    </ul>

    <h1>Overall age stats</h1>
    <h1>Oldest player age is: {{max_age}}</h1>
    <h1>Youngest player age is: {{min_age}}</h1>
    <h1>Average Career length overall is: {{avg_career}}</h1>
    <h1>Youngest player Career length overall is: {{min_career}}</h1>
    <h1>Oldest player Career length overall is: {{max_career}}</h1>
    <br>


    {% for stat in position_stats %}
        <h1>Stats for position: {{stat.position}} !</h1>
        <h2>Age distributions</h2>

        <ul>
            {% for group, percent in stat.pos_age_groups.items() %}
            <li>{{ group }}: {{ percent | round(2) }}%</li>
            {% endfor %}
        </ul>

            <h1>Average age: {{stat.avg_age}}</h1>
            <h1>Min age: {{stat.min_age}}</h1>
            <h1>Max age: {{stat.max_age}}</h1>
            <h1>Average career length: {{stat.avg_career}}</h1>
            <h1>Min career length: {{stat.min_career}}</h1>
            <h1>Max career length: {{stat.max_career}}</h1>
            <br>
    {%endfor%}
</body>
</html>